{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{useNavigate}from'react-router-dom';import{useSocket}from'../context/SocketProvider';import'../RoomManagement.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const RoomManagement=()=>{const[title,setTitle]=useState('');const[email,setEmail]=useState('');const[description,setDescription]=useState('');const[rooms,setRooms]=useState([]);const[error,setError]=useState('');const socket=useSocket();const navigate=useNavigate();useEffect(()=>{const storedUser=localStorage.getItem('user');const storeToken=localStorage.getItem('token');if(storedUser&&storeToken){const user=JSON.parse(storedUser);setEmail(user.email);}else{navigate('/login');}fetchRooms();},[]);const fetchRooms=async()=>{try{const token=localStorage.getItem('token');const response=await fetch('http://localhost:5550/api/rooms',{headers:{Authorization:`Bearer ${token}`}});const data=await response.json();setRooms(data);}catch(err){setError('Could not fetch rooms. Please try again later.');}};const handleCreateRoom=async e=>{e.preventDefault();setError('');try{const token=localStorage.getItem('token');const response=await fetch('http://localhost:5550/api/rooms',{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${token}`},body:JSON.stringify({title,description})});if(response.ok){fetchRooms();setTitle('');setDescription('');}else{const data=await response.json();setError(data.message||'Failed to create room. Try again.');}}catch(err){setError('Server error. Please try again later.');}};const handleJoinRoom=useCallback(data=>{const{room}=data;navigate(`/room/${room}`);},[navigate]);const joinRoomFromList=roomTitle=>{if(email){socket.emit('room:join',{email,room:roomTitle});}else{setError('Email is required to join a room');}};useEffect(()=>{socket.on('room:join',handleJoinRoom);return()=>{socket.off('room:join',handleJoinRoom);};},[socket,handleJoinRoom]);return/*#__PURE__*/_jsxs(\"div\",{className:\"room-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create a Room\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCreateRoom,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Room Title\",value:title,onChange:e=>setTitle(e.target.value),required:true}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Room Description\",value:description,onChange:e=>setDescription(e.target.value),required:true}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Create Room\"})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Rooms\"}),/*#__PURE__*/_jsx(\"div\",{className:\"room-list\",children:rooms.map(room=>/*#__PURE__*/_jsxs(\"div\",{className:\"room-item\",onClick:()=>joinRoomFromList(room.title),children:[/*#__PURE__*/_jsx(\"h3\",{children:room.title}),/*#__PURE__*/_jsx(\"p\",{children:room.description})]},room._id))})]});};export default RoomManagement;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useNavigate","useSocket","jsx","_jsx","jsxs","_jsxs","RoomManagement","title","setTitle","email","setEmail","description","setDescription","rooms","setRooms","error","setError","socket","navigate","storedUser","localStorage","getItem","storeToken","user","JSON","parse","fetchRooms","token","response","fetch","headers","Authorization","data","json","err","handleCreateRoom","e","preventDefault","method","body","stringify","ok","message","handleJoinRoom","room","joinRoomFromList","roomTitle","emit","on","off","className","children","onSubmit","type","placeholder","value","onChange","target","required","map","onClick","_id"],"sources":["/Users/md.golamrabbani/Desktop/web-rtc/React-webRTC/client/src/screens/RoomManagement.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useSocket } from '../context/SocketProvider';\nimport '../RoomManagement.css';\n\nconst RoomManagement = () => {\n  const [title, setTitle] = useState('');\n  const [email, setEmail] = useState('');\n  const [description, setDescription] = useState('');\n  const [rooms, setRooms] = useState([]);\n  const [error, setError] = useState('');\n\n  const socket = useSocket();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const storedUser = localStorage.getItem('user');\n    const storeToken = localStorage.getItem('token')  \n    if (storedUser && storeToken ) {\n      const user = JSON.parse(storedUser);\n      setEmail(user.email); \n    }\n    else{\n      navigate('/login');\n    }\n    fetchRooms();\n  }, []);\n\n  const fetchRooms = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await fetch('http://localhost:5550/api/rooms', {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      const data = await response.json();\n      setRooms(data);\n    } catch (err) {\n      setError('Could not fetch rooms. Please try again later.');\n    }\n  };\n\n  const handleCreateRoom = async (e) => {\n    e.preventDefault();\n    setError('');\n  \n    try {\n      const token = localStorage.getItem('token');\n      const response = await fetch('http://localhost:5550/api/rooms', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ title, description }),\n      });\n  \n      if (response.ok) {\n        fetchRooms(); \n        setTitle('');\n        setDescription('');\n      } else {\n        const data = await response.json();\n        setError(data.message || 'Failed to create room. Try again.');\n      }\n    } catch (err) {\n      setError('Server error. Please try again later.');\n    }\n  };\n\n  const handleJoinRoom = useCallback((data) => {\n    const { room } = data;\n    navigate(`/room/${room}`);\n  }, [navigate]);\n\n  const joinRoomFromList = (roomTitle) => {\n    if (email) {\n      socket.emit('room:join', { email, room: roomTitle });\n    } else {\n      setError('Email is required to join a room');\n    }\n  };\n\n  useEffect(() => {\n    socket.on('room:join', handleJoinRoom);\n    return () => {\n      socket.off('room:join', handleJoinRoom);\n    };\n  }, [socket, handleJoinRoom]);\n\n  return (\n    <div className=\"room-container\">\n      <h2>Create a Room</h2>\n      <form onSubmit={handleCreateRoom}>\n        <input\n          type=\"text\"\n          placeholder=\"Room Title\"\n          value={title}\n          onChange={(e) => setTitle(e.target.value)}\n          required\n        />\n        <textarea\n          placeholder=\"Room Description\"\n          value={description}\n          onChange={(e) => setDescription(e.target.value)}\n          required\n        ></textarea>\n        {error && <p className=\"error\">{error}</p>}\n        <button type=\"submit\">Create Room</button>\n      </form>\n      \n      <h2>Rooms</h2>\n      <div className=\"room-list\">\n        {rooms.map((room) => (\n          <div key={room._id} className=\"room-item\" onClick={() => joinRoomFromList(room.title)}>\n            <h3>{room.title}</h3>\n            <p>{room.description}</p>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default RoomManagement;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}